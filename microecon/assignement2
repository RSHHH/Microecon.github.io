
#Data Introduction and Processing
 In order to investigate the correlation between film quality and economic perfomance, I collected box offices data and comment scores of more than 400 Chinese films released during 2014-2017. Because box offices I collected are nominal data, which are related to inflation. Whatâ€™s more, the economic revenue of a flim is restricted by the scale of film market.For example, due to the development of movie industry, the box office of a film showed in 2017 must be higher than that of its counterpart with the similar quality and comment. In order to let those data comparable, I
adjusted the box office.
 It is apparently that Chinese films tend to issue on holidays and festivals and we want to know whether issuing movies on special days contribute to box office. First, special days are defined as Spring Festival, May Day, National Day and summer vacation(June to July). Then all movies in the sample are divided into two groups: a group including those films with special schedule and the other one including remainder.
 
#Global Regression
```{r}
setwd("c:/Users/Administrator/Desktop/R")
film<-read.table("film_box.csv",header=TRUE,sep=",")
attach(film)
library(ggplot2)
film$Time<-factor(film$special,levels=c(0,1),labels=c("ordinary time","special time"))
ggplot(data=film,aes(x=score,y=lnbox,shape=Time,color=Time))+geom_point()+geom_smooth(method=lm)
#plot the scatters and fitting line
```
setwd("c:/Users/Administrator/Desktop/R")
library(zoo)
library(splines)
library(ggplot2)
film<-read.table("film_box.csv",header=TRUE,sep=",")
attach(film)
film$Time<-factor(film$special,levels=c(0,1),labels=c("ordinary time","special time"))
scorelims<-range(score)
score.grid<-seq(from=scorelims[1],to=scorelims[2])
film$color[film$Time=="ordinary time"]<-"darkgrey"
film$color[film$Time=="special time"]<-"grey"
plot(score,lnbox1,xlim=scorelims,cex=.5,col=film$color,pch=16,pin=c(3,4))
fit1 <- lm(lnbox1~bs(score, knots = c(40,70),df=3),data=film,subset=(Time == "ordinary time"))
pred1 <- predict(fit1,newdata=list(score=score.grid),se=TRUE)
se.bands <- cbind(pred1$fit + 2*pred1$se.fit, pred1$fit - 2*pred1$se.fit)
lines(score.grid,pred1$fit,lwd=2,lty=1,col="darkblue")
matlines(score.grid,se.bands,lwd=1,lty=3,col="darkblue")
fit2 <- lm(lnbox1~bs(score, knots = c(40,70), df = 3),data=film,subset=(Time == "special time"))
pred2 <- predict(fit2,newdata=list(score=score.grid),se=TRUE)
se2.bands <- cbind(pred2$fit + 2*pred2$se.fit, pred2$fit - 2*pred2$se.fit)
lines(score.grid,pred2$fit,lwd=2,lty=1,col="blue")
matlines(score.grid,se2.bands,lwd=1,lty=3,col="blue")
fit3 <- lm(lnbox1~ns(score, knots = c(40,70)),data=film,subset=(Time == "ordinary time"))
pred3 <- predict(fit3,newdata=list(score=score.grid),se=TRUE)
se3.bands <- cbind(pred3$fit + 2*pred3$se.fit, pred3$fit - 2*pred3$se.fit)
lines(score.grid,pred3$fit,lwd=2,lty=1,col="darkorange")
matlines(score.grid,se3.bands,lwd=1,lty=3,col="darkorange")
fit4 <- lm(lnbox1~ns(score, knots = c(40,70)),data=film,subset=(Time == "special time"))
pred4 <- predict(fit4,newdata=list(score=score.grid),se=TRUE)
se4.bands <- cbind(pred4$fit + 2*pred4$se.fit, pred4$fit - 2*pred4$se.fit)
lines(score.grid,pred4$fit,lwd=2,lty=1,col="orange")
matlines(score.grid,se4.bands,lwd=1,lty=3,col="orange")
abline(v=c(40,70),lty=3)
legend("topright",col=c("darkblue","blue","darkorange","orange"),lwd=0.5,cex=0.5,legend=c("Cubic Spline/ordinarytime","Cubic Spline/specialtime","Natural Cubic Spline/ordinarytime","Natural Cubic Spline/specialtime"))
      
